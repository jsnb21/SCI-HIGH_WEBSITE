<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="user-scalable=no">
        <link rel="icon" href="icon/icon.png" type="image/png">
        <link rel="apple-touch-icon" href="icon/icon.png">
        <link rel="stylesheet" type="text/css" href="fonts/gamefont.css">
        <title>SCI-HIGH</title>
    </head>
    <body style="background-color: black">
        <script type="text/javascript" src="js/libs/pixi.js"></script>
        <script type="text/javascript" src="js/libs/pixi-tilemap.js"></script>
        <script type="text/javascript" src="js/libs/pixi-picture.js"></script>
        <script type="text/javascript" src="js/libs/fpsmeter.js"></script>
        <script type="text/javascript" src="js/libs/lz-string.js"></script>
        <script type="text/javascript" src="js/libs/iphone-inline-video.browser.js"></script>
        <script type="text/javascript" src="js/rpg_core.js"></script>
        <script type="text/javascript" src="js/rpg_managers.js"></script>
        <script type="text/javascript" src="js/rpg_objects.js"></script>
        <script type="text/javascript" src="js/rpg_scenes.js"></script>
        <script type="text/javascript" src="js/rpg_sprites.js"></script>
        <script type="text/javascript" src="js/rpg_windows.js"></script>
        <script type="text/javascript" src="js/plugins.js"></script>
        <script type="text/javascript" src="js/main.js"></script>

        <!-- Firebase SDK -->
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

        <script>        
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD-Q2woACHgMCTVwd6aX-IUzLovE0ux-28",
            authDomain: "sci-high-website.firebaseapp.com",
            projectId: "sci-high-website",
            storageBucket: "sci-high-website.appspot.com", // corrected typo: '.app' → '.appspot.com'
            messagingSenderId: "451463202515",
            appId: "1:451463202515:web:e7f9c7bf69c04c685ef626"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Function to send variables to Firebase
        function sendVariablesToFirebase() {
            const db = firebase.database();

            const htmlValue = $gameVariables.value(22);
            const cssValue = $gameVariables.value(23);
            const pythonValue = $gameVariables.value(24);
            const dsValue = $gameVariables.value(25);

            db.ref('gameVariables').set({
                htmlValue,
                cssValue,
                pythonValue,
                dsValue
            });
        }

        // Call sendVariablesToFirebase every 3 seconds
        setInterval(sendVariablesToFirebase, 3000);

        // Function to check Firebase connection
        function checkFirebaseConnection() {
            if (typeof firebase === 'undefined') {
                console.error("Firebase SDK is not loaded.");
                return false;
            }

            const db = firebase.database();
            const testRef = db.ref("/connectionTest");

            return new Promise((resolve, reject) => {
                testRef.once('value')
                    .then((snapshot) => {
                        console.log("✅ Firebase connected successfully.");
                        resolve(true);
                    })
                    .catch((error) => {
                        console.error("❌ Failed to connect to Firebase:", error);
                        resolve(false);
                    });
            });
        }

        // Run connection check when page loads
        window.addEventListener('load', () => {
            checkFirebaseConnection().then(isConnected => {
                if (isConnected) {
                    console.log("✅ Connected to Firebase!");
                } else {
                    console.log("❌ Not connected to Firebase.");
                }
            });
        });
        </script>
    </body>
</html>
